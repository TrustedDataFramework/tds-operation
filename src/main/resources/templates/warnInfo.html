<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
  <meta charset="UTF-8">
  <title>预警信息</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="renderer" content="webkit">
  <link rel="stylesheet" type="text/css" href="css/style.css"/>
</head>

<body class="body_main">
<!--左边菜单-->
<div id="sider" class="sider"></div>
<div class="wrapMain">
  <!--头部-->
  <div class="topInfo" id="topInfo">
  </div>
  <div class="mainBox">
	  <div class="tabBox">
		  <div class="borderRadius5 bosshdow pointInfo first_div">
			  <div class="col">
				  <h4 class="ht">当前节点发送邮箱</h4>
				  <p th:text="${mail.getSender()}">88888888888@126.com</p>
			  </div>
			  <div class="col">
				  <h4 class="ht">当前节点接收邮箱</h4>
				  <p th:text="${mail.getReceiver()}">88888888888@126.com</p>
			  </div>

			  <div class="line"></div>

		  </div>
		  <div class="borderRadius5 bosshdow boxdiv">
			  <h3 class="title">修改邮箱信息</h3>
			  <div class="dataBox">
					  <div class="din">
						  <label class="lab">绑定发送邮箱：</label>
						  <input class="borderRadius5 editIn" placeholder="地址信息" id="txt_send"/>
					  </div>
					  <div class="din din-mess">
						  <label class="lab"></label>
						  <p class="n_tips">当前支持outlook邮箱作为发送邮箱</p>
					  </div>
					  <div class="din">
						  <label class="lab">发送邮箱密码：</label>
						  <input type="password" class="borderRadius5 editIn" id="txt_password"/>
					  </div>
					  <div class="din din-mess">
						  <label class="lab"></label>
						  <p class="n_tips">此密码选项为发送邮箱密码</p>
					  </div>
					  <div class="din">
						  <label class="lab">绑定接收邮箱：</label>
						  <input class="borderRadius5 editIn" placeholder="" id="txt_receiver" />
					  </div>
					  <div class="btnbox"><button class="btndefault borderRadius5 btn" id="bt_editmail">确认修改</button></div>
			  </div>
		  </div>
	  </div>
	  <div class="space"></div>
  </div>
</div>
<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script>
  $("#sider").load("/sider",function(){
	  $(".siderNav .l4").addClass('cur')
  });

  $("#topInfo").load("/header")

</script>

<script th:inline="javascript">
	$("#txt_send").val([[${mail.getSender()}]]);
	$("#txt_password").val([[${mail.getPassword()}]]);
	$("#txt_receiver").val([[${mail.getReceiver()}]]);
	$(function () {
		$('#bt_editmail').click(function () {
			var emailReg = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
			var send = document.getElementById("txt_send").value;
			var receiver = document.getElementById("txt_receiver").value;
			var password = document.getElementById("txt_password").value;
			if (!emailReg.test(send)) {
				Swal.fire("", "发送邮箱格式不正确", "error");
				// alert("发送邮箱格式不正确!");
				// swal("", "test", "success");
				return;
			};
			if (!emailReg.test(receiver)) {
				Swal.fire("", "接受邮箱格式不正确", "error");
				// alert("接受邮箱格式不正确!");
				return;
			};
			if (password == "" || password == null){
				Swal.fire("", "请输入密码", "error");
				return;
			}
			var urlData = {sender: $('#txt_send').val(), receiver: $('#txt_receiver').val(),password:$('#txt_password').val()};
			Swal.fire({
				type: 'question', // 弹框类型
				title: '', //标题
				text: "是否绑定邮箱！", //显示内容

				confirmButtonColor: '#3085d6',// 确定按钮的 颜色
				confirmButtonText: '确定',// 确定按钮的 文字
				showCancelButton: true, // 是否显示取消按钮
				cancelButtonColor: '#d33', // 取消按钮的 颜色
				cancelButtonText: "取消", // 取消按钮的 文字

				focusCancel: true, // 是否聚焦 取消按钮
				reverseButtons: true  // 是否 反转 两个按钮的位置 默认是  左边 确定  右边 取消
			}).then(function(isConfirm){
				try {
					//判断 是否 点击的 确定按钮
					if (isConfirm.value) {
						$.get('editmail', urlData, function (result) {
							$(".modal").css("display", "none");
							$(".modal-backdrop").css("display", "none");
							if(result.code == 2000){
								Swal.fire({
									type: 'success', // 弹框类型
									title: '', //标题
									text: "绑定成功！", //显示内容

									confirmButtonColor: '#3085d6',// 确定按钮的 颜色
									confirmButtonText: '确定',// 确定按钮的 文字
									showCancelButton: false, // 是否显示取消按钮
									cancelButtonColor: '#d33', // 取消按钮的 颜色
									cancelButtonText: "取消", // 取消按钮的 文字

									focusCancel: true, // 是否聚焦 取消按钮
									reverseButtons: true  // 是否 反转 两个按钮的位置 默认是  左边 确定  右边 取消
								}).then(function(isConfirm){
									try {
										//判断 是否 点击的 确定按钮
										if (isConfirm.value) {
											window.location.reload();
										}
									} catch (e) {
										alert(e);
									}
								});
							}
						}, 'json');

					}
					else {
						Swal.fire("取消", "点击了取消", "error");
					}
				} catch (e) {
					alert(e);
				}
			});

		});
	});
	//
</script>


   </body>
</html>

