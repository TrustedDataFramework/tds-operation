<!DOCTYPE html>
<html>
	<head lang="en">
		<meta charset="UTF-8">
		<title>浏览器监测</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="renderer" content="webkit">
		<link rel="stylesheet" type="text/css" href="css/style.css"/>

		<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>

	</head>
      
   <body class="body_main">
   	  <!--左边菜单-->
      <div id="sider" class="sider"></div>
	  <div class="wrapMain">
	  	 <!--头部-->
	  	 <div class="topInfo" id="topInfo">	  
	  	 </div>
	  	 <div class="mainBox">
	  	 	 <div class="tabBox tabBox_out browser_box">
		  	 	 <div class="borderRadius5 bosshdow boxdiv first_div">
		  	 	 	<h3 class="title">监测浏览器</h3>
		  	 	 	<div class="dataBox">
		  	 	 	   <div class="browser-info">
						   <p>IP:<span id="ip"></span></p>
						   <p>端口：8080</p>
						   <p>版本：<span id="version"></span></p>
						   <p>运行状态：<span id="status"></span></p>
						</div>
		 
						<div class="btnbox">
							<a class="btndefault borderRadius5 browser-btn" onclick="showModal2()">停止</a>
							<a class="btndefault borderRadius5 browser-btn" onclick="showModal1()">启动</a>
							<a class="btndefault borderRadius5 browser-btn" onclick="showModal3()">重启</a>
							<span class="btndefault borderRadius5 browser-btn" onclick="search()">访问</span>
						</div>
		  	 	 		
		  	 	 	</div>
		  	 	 </div>
	  	 	 </div>
	  	 	 <div class="space"></div>
	  	 </div>
	  </div>

	  <!--输入密码弹出框-->

	  <div class="modal" id="modal1">
		  <div class="modal-by-dialog modal-point">
			  <a onclick="hideModal1()" class="btnClose" style="color:#333333"></a>
			  <h3 class="modal_title">密码</h3>
			  <div class="form">
				  <div class="col clearfix">
					  <div class="fin"><input class="borderRadius5" type="text" placeholder="请输入密码" id="password1"/></div>
				  </div>
				  <div class="fbtnbox">
					  <a  class="borderRadius5 fbtn" onclick="hideModal1()" id = "submit1">提交</a>
				  </div>

			  </div>
		  </div>

	  </div>

	  <div class="modal" id="modal2">
		  <div class="modal-by-dialog modal-point">
			  <a onclick="hideModal2()" class="btnClose" style="color:#333333"></a>
			  <h3 class="modal_title">密码</h3>
			  <div class="form">
				  <div class="col clearfix">
					  <div class="fin"><input class="borderRadius5" type="text" placeholder="请输入密码" id="password2"/></div>
				  </div>
				  <div class="fbtnbox">
					  <a  class="borderRadius5 fbtn" onclick="hideModal2()" id = "submit2">提交</a>
				  </div>

			  </div>
		  </div>

	  </div>

	  <div class="modal" id="modal3">
		  <div class="modal-by-dialog modal-point">
			  <a onclick="hideModal3()" class="btnClose" style="color:#333333"></a>
			  <h3 class="modal_title">密码</h3>
			  <div class="form">
				  <div class="col clearfix">
					  <div class="fin"><input class="borderRadius5" type="text" placeholder="请输入密码" id="password3"/></div>
				  </div>
				  <div class="fbtnbox">
					  <a  class="borderRadius5 fbtn" onclick="hideModal3()" id = "submit3">提交</a>
				  </div>

			  </div>
		  </div>

	  </div>
   </body>

</html>
<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script>
 	$("#sider").load("/sider",function(){
 		$(".siderNav .l7").addClass('cur')
 	});
 	
 	$("#topInfo").load("/header")

	function showModal1(){
		$("#modal1").addClass('modal_in');
	}

	function hideModal1(){

		$("#modal1").removeClass('modal_in');
	}
	function showModal2(){
		$("#modal2").addClass('modal_in');
	}

	function hideModal2(){
		$("#modal2").removeClass('modal_in');
	}
	function showModal3(){
		$("#modal3").addClass('modal_in');
	}

	function hideModal3(){
		$("#modal3").removeClass('modal_in');
	}

	$(function () {
		$.get('getLocalIp', function (result) {
			if(result){
				document.getElementById("ip").innerHTML = result.data;
			}
		}, 'json');

		$.get('detectExplorer', function (result) {
			if(result){
				document.getElementById("version").innerHTML = result.data;
				document.getElementById("status").innerHTML = "未运行";
			}
		}, 'json');
	});

	$('#submit1').click(function () {
		var urlData = {password: $('#password1').val()};
		$.get('startWeb',urlData, function (result) {
			if(result.code == 2000){
				document.getElementById("version").innerHTML = result.data;
				document.getElementById("status").innerHTML = "成功";
				alert("启动成功");
			}else{
				alert("启动失败");
			}
		}, 'json');
	});

	$('#submit2').click(function () {
		var urlData = {password: $('#password2').val()};
		$.get('stopWeb',urlData, function (result) {
			console.log(result.code)
			if(result.code == 2000){
				document.getElementById("version").innerHTML = result.data;
				document.getElementById("status").innerHTML = "未运行";
				alert("停止成功");
			}else{
				alert("停止失败");
			}
		}, 'json');
	});

	$('#submit3').click(function () {
		var urlData = {password: $('#password3').val()};
		$.get('restartWeb',urlData, function (result) {
			if(result.code == 2000){
				document.getElementById("version").innerHTML = result.data;
				document.getElementById("status").innerHTML = "成功";
				alert("重启成功");
			}else{
				alert("重启失败");
			}
		}, 'json');
	});

	function search() {
		if(document.getElementById("version").innerHTML != ""){
			let path = "http://" + document.getElementById("ip").innerHTML + ":8080"
			window.open(path,"_blank");
		}else{
			alert("请启动浏览器");
		}
	}
</script>
